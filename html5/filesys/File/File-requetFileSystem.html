<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <p>file_system</p>
    <script>
      //请求临时空间；
      window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;
      window.requestFileSystem(window.TEMPORARY,6*1024*1024,function(file_system){
        console.log("创建临时存储空间：" + file_system.name);
        file_system.root.getFile('test.txt',{create: true,exclusive: true},function(file){
          console.log('文件创建成功' + file.name);
        },errorCallback);
        //写入数据
        //获取创建的文件
        file_system.root.getFile('test.txt',{create: false},function(file){
          //创建写入对象
          file.createWriter(function(fileWriter){
            //在指定位置写入
            fileWriter.seek(fileWriter.length);
            //初始化文本数据对象
            var blob = Blob(['hello world']);
            //写入数据
            fileWriter.write(blob);
          });
        },errorCallback);
      },errorCallback);

      //请求永久空间；
      window.requestFileSystem(window.PERSISTENT,1*1024*1024,function(file_system){
        console.log("创建永久存储空间：" + file_system.name);
        file_system.root.getFile('test.txt',{create: true,exclusive: true},function(file){
          console.log('文件创建成功' + file.name);
        },errorCallback);
        file_system.root.getFile('test.txt',{create: false},function(file){
          file.remove(function(){
            console.log("文件删除成功");
          })
        })
      },errorCallback);
      //errorCallback
      function errorCallback(e) {
        var msg = '';
        switch(e.code) {
          case FileError.QUOTA_EXCEEDED_ERR: msg = '超出允许最大长度'; break;
          case FileError.NOT_FOUND_ERR: msg= '没有找到指定节点'; break;
          case FileError.SECURITY_ERR: msg = '访问拒绝'; break;
          case FileError.INVALID_STATA_ERR: msg = '不被允许的执行对象接口状态'; break;
          case FileError.INVALID_MODIFICATION_ERR: msg = '不被允许的修改请求'; break;
          case FileError.ENCODING_ERR: msg = '路径不完整或无效'; break;
          case FileError.NOT_READABLE_ERR: msg = '文件或目录没有读权限'; break;
          case FileError.PATH_EXISTS_ERR: msg = '文件或目录已存在相同路径';break;
          case FileError.TYPE_MISMATCH_ERR: msg = '错误的入口目录类型';break;
          default: msg = '未知错误'; break;
        }
        console.log('Error: ' + msg);
      }
    </script>
  </body>
</html>
